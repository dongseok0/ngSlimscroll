angular.module("jkuri.slimscroll",[]).directive("ngSlimscroll",["$document","$window","$compile",function(c,b,a){var d=function(h,g,f){var e=undefined;if(f.height!==0&&f.height!==undefined){e=f.height}else{if(g[0].clientHeight!==0){e=g[0].clientHeight}else{e=250}}h.width=f.width||g[0].clientWidth||"auto";h.height=e;h.size=f.size||"7px";h.color=f.color||"#000";h.position=f.position||"right";h.distance=f.distance||"1px";h.borderRadius=f.borderRadius||"3px";h.start=f.start||"top";h.alwaysVisible=h.$eval(f.alwaysVisible)||true;h.barDraggable=h.$eval(f.barDraggable)||true;h.wheelStep=f.wheelStep||20;h.opacity=f.opacity||0.5;h.enabled=h.$eval(f.enabled)||true};return{restrict:"A",scope:true,link:function(q,m,p){d(q,m,p);var i=m[0];var g=30,l,h=false,e=false,j;m.css({overflow:"hidden",width:q.width+"px",height:q.height+"px"});var f=angular.element("<div></div>");f.css({position:"relative",overflow:"hidden",width:q.width+"px",height:q.height+"px"});var n=angular.element('<div ng-mousedown="makeBarDraggable($event)""></div>');n.css({background:q.color,width:q.size,position:"absolute",top:"0",opacity:q.opacity,display:q.alwaysVisible?"block":"none","border-radius":q.borderRadius,"z-index":"99",cursor:"pointer"});var k=(q.position==="right")?{right:q.distance}:{left:q.distance};n.css(k);m.wrap(f);m.append(n);a(n)(q);q.makeBarDraggable=function(){n.bind("mousedown",function(u){var t=parseFloat(n.css("top")),r=u.pageY,s=true;c.bind("mousemove",function(v){n.css({top:t+v.pageY-r+"px"});q.scrollContent(0,n[0].offsetTop,false)});c.bind("mouseup",function(v){s=false;c.unbind("mousemove")});return}).bind("selectstart",function(r){r.preventDefault();r.stopPropagation();return false})};q.getBarHeight=function(){var s=Math.max((i.offsetHeight/i.scrollHeight)*i.offsetHeight,g);n.css({height:s+"px"});var r=s===i.offsetHeight?"none":"block";n.css({display:r})};q.attachWheel=function(r){if(b.addEventListener){r.addEventListener("DOMMouseScroll",q.onWheel,false);r.addEventListener("mousewheel",q.onWheel,false)}else{c.addEventListener("onmousewheel",q.onWheel)}};q.detachWheel=function(r){if(b.removeEventListener){r.removeEventListener("DOMMouseScroll",q.onWheel,false);r.removeEventListener("mousewheel",q.onWheel,false)}else{c.removeEventListener("onmousewheel",q.wheel)}};q.onWheel=function(s){var s=s||b.event;var t=0;if(s.wheelDelta){t=-s.wheelDelta/120}if(s.detail){t=s.detail/3}var r=s.target||s.srcTarget||s.srcElement;q.scrollContent(t,true);if(s.preventDefault&&!h){s.preventDefault()}if(!h){s.returnValue=false}};q.scrollContent=function(x,t,r){h=false;var w=x,v=i.offsetHeight-n[0].offsetHeight,u,s;if(t){w=parseInt(n.css("top"),10)+x*parseInt(q.wheelStep,10)/100*n[0].offsetHeight;w=Math.min(Math.max(w,0),v);w=(x>0)?Math.ceil(w):Math.floor(w);n.css({top:w+"px"})}u=parseInt(n.css("top"),10)/(i.offsetHeight-n[0].offsetHeight);w=u*(i.scrollHeight-i.offsetHeight);i.scrollTop=w};n.bind("touchstart",function(s,r){if(s.originalEvent.touches.length){j=s.originalEvent.touches[0].pageY}});n.bind("touchmove",function(s){if(!h){s.originalEvent.preventDefault()}if(s.originalEvent.touches.length){var r=(j-s.originalEvent.touches[0].pageY)/o.touchScrollStep;scrollContent(r,true);j=s.originalEvent.touches[0].pageY}});p.$observe("enabled",function(){q.enabled=q.$eval(p.enabled);if(q.enabled===false){n.remove();q.detachWheel(i)}else{m.append(n);q.attachWheel(i)}});q.getBarHeight();q.attachWheel(i);q.makeBarDraggable()}}}]);